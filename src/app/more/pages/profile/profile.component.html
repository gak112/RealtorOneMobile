<ion-header>
  <ion-toolbar>
    <ion-icon class="icon-close" (click)="dismiss()" name="arrow-back-outline"></ion-icon>
    <ion-title>Your Profile</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding" style="--background: var(--content-background)">
  <form [formGroup]="profileForm" novalidate>
    <div class="div-profile-main">
      <ion-img class="img-icon" src="assets/img/profile2.png"></ion-img>

      <div class="div-profile-main-img">
        <div class="div-img-settings">
          <ion-img
            src="https://img.freepik.com/premium-photo/happy-man-ai-generated-portrait-user-profile_1119669-1.jpg?w=2000">
          </ion-img>
          <ion-icon name="person-outline" style="height: 50%; width: 50%; color: var(--color-red)"></ion-icon>
          <ion-icon class="icon-edit" name="create-outline"></ion-icon>
        </div>
      </div>

      <!-- First Name -->
      <div class="div-formgroup">
        <ion-input autocomplete="off" mode="md" label="First Name" label-placement="floating" fill="outline" type="text"
          placeholder="First Name" formControlName="firstName">
        </ion-input>
        @if (showError('firstName','required')) {
        <ion-label class="label-info"><ion-icon name="information-circle"></ion-icon> First name is
          required.</ion-label>
        }
        @if (showError('firstName','minlength')) {
        <ion-label class="label-info"><ion-icon name="information-circle"></ion-icon> Minimum 3 characters.</ion-label>
        }
      </div>

      <!-- Last Name -->
      <div class="div-formgroup">
        <ion-input autocomplete="off" mode="md" label="Last Name" label-placement="floating" fill="outline" type="text"
          placeholder="Last Name" formControlName="lastName">
        </ion-input>
        @if (showError('lastName','required')) {
        <ion-label class="label-info"><ion-icon name="information-circle"></ion-icon> Last name is required.</ion-label>
        }
        @if (showError('lastName','minlength')) {
        <ion-label class="label-info"><ion-icon name="information-circle"></ion-icon> Minimum 3 characters.</ion-label>
        }
      </div>

      <!-- Mobile -->
      <div class="div-formgroup">
        <ion-input autocomplete="off" mode="md" label="Mobile Number" label-placement="floating" fill="outline"
          type="tel" placeholder="Enter Mobile Number" formControlName="mobileNumber">
        </ion-input>

        @if (profileForm.controls.mobileNoVerified.value) {
        <span class="span-verified">Verified</span>
        } @else {
        <span class="span-verify">Verify</span>
        }

        @if (showError('mobileNumber','required')) {
        <ion-label class="label-info"><ion-icon name="information-circle"></ion-icon> Phone is required.</ion-label>
        }
        @if (showError('mobileNumber','pattern')) {
        <ion-label class="label-info"><ion-icon name="information-circle"></ion-icon> Enter a valid 10-digit
          number.</ion-label>
        }
        @if (mobileChecking()) {
        <ion-label class="label-info"><ion-icon name="information-circle"></ion-icon> Checking phone…</ion-label>
        }
        @if (mobileTaken()) {
        <ion-label class="label-info"><ion-icon name="information-circle"></ion-icon> Phone number already taken. Please
          enter another phone number.</ion-label>
        }
      </div>

      <!-- Email -->
      <div class="div-formgroup">
        <ion-input style="--padding-end:85px" autocomplete="off" mode="md" label="Email" label-placement="floating"
          fill="outline" type="email" placeholder="Email" formControlName="email">
        </ion-input>

        @if (profileForm.controls.emailVerified.value) {
        <span class="span-verified">Verified</span>
        } @else {
        <span class="span-verify">Verify</span>
        }

        @if (showError('email','email')) {
        <ion-label class="label-info"><ion-icon name="information-circle"></ion-icon> Enter a valid email.</ion-label>
        }
        @if (emailChecking()) {
        <ion-label class="label-info"><ion-icon name="information-circle"></ion-icon> Checking email…</ion-label>
        }
        @if (emailTaken()) {
        <ion-label class="label-info"><ion-icon name="information-circle"></ion-icon> Email already taken. Please enter
          another email.</ion-label>
        }
      </div>

      <!-- DOB -->
      <div class="div-formgroup">
        <ion-input autocomplete="off" mode="md" label="Date Of Birth" label-placement="floating" fill="outline"
          type="date" placeholder="Enter Date of Birth" formControlName="dob">
        </ion-input>
      </div>

      <!-- Gender -->
      <div class="div-formgroup" style="margin-bottom:0;">
        <ion-select aria-label="Gender" interface="popover" placeholder="Gender" fill="outline" label="Gender" mode="md"
          formControlName="gender">
          <ion-select-option value="male">Male</ion-select-option>
          <ion-select-option value="female">Female</ion-select-option>
          <ion-select-option value="other">Other</ion-select-option>
          <ion-select-option value="preferNotToDisclose">Prefer Not To Disclose</ion-select-option>
        </ion-select>
      </div>
    </div>
  </form>
</ion-content>

<ion-footer>
  <ion-button mode="ios" expand="block" [disabled]="profileForm.invalid || saving() || mobileTaken() || emailTaken()"
    (click)="updateProfile()">
    @if (saving()) { <ion-spinner name="bubbles"></ion-spinner> } @else { Update Profile }
  </ion-button>
</ion-footer>